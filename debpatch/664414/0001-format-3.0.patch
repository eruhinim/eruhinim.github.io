From fbd85a479b53e654eb8e918fa187dbb7028044f5 Mon Sep 17 00:00:00 2001
From: Jari Aalto <jari.aalto@cante.net>
Date: Mon, 27 Feb 2012 06:04:32 -0500
Subject: [PATCH] format-3.0
Organization: Private
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 8bit

Signed-off-by: Jari Aalto <jari.aalto@cante.net>
---
 debian/changelog                                   |    8 ++++++++
 debian/compat                                      |    2 +-
 debian/control                                     |    4 ++--
 debian/patches/00list                              |   16 ----------------
 .../{21_fixversion.dpatch => 21_fixversion.patch}  |    8 ++------
 ...{22_disableconf.dpatch => 22_disableconf.patch} |    8 ++------
 .../{31_usepqsql.dpatch => 31_usepqsql.patch}      |   12 ++++--------
 ...{41_syntaxwhere.dpatch => 41_syntaxwhere.patch} |    9 ++-------
 ...hmailheader.dpatch => 42_graphmailheader.patch} |    8 ++------
 .../{43_cdfsyntax.dpatch => 43_cdfsyntax.patch}    |    8 ++------
 ... => 61_php_fix_html_and_input_validation.patch} |   10 +++-------
 ...ang.dpatch => 71_sh_bd_purge_add_shebang.patch} |    8 ++------
 ...{81_phpdbconfig.dpatch => 81_phpdbconfig.patch} |   10 +++-------
 .../{98_autoheader.dpatch => 98_autoheader.patch}  |    8 ++------
 .../{99_autoconf.dpatch => 99_autoconf.patch}      |    8 ++------
 debian/patches/series                              |   16 ++++++++++++++++
 debian/rules                                       |    5 ++---
 debian/source/format                               |    2 +-
 18 files changed, 56 insertions(+), 94 deletions(-)
 delete mode 100644 debian/patches/00list
 rename debian/patches/{21_fixversion.dpatch => 21_fixversion.patch} (59%)
 rename debian/patches/{22_disableconf.dpatch => 22_disableconf.patch} (73%)
 rename debian/patches/{31_usepqsql.dpatch => 31_usepqsql.patch} (84%)
 rename debian/patches/{41_syntaxwhere.dpatch => 41_syntaxwhere.patch} (63%)
 rename debian/patches/{42_graphmailheader.dpatch => 42_graphmailheader.patch} (87%)
 rename debian/patches/{43_cdfsyntax.dpatch => 43_cdfsyntax.patch} (76%)
 rename debian/patches/{61_php_fix_html_and_input_validation.dpatch => 61_php_fix_html_and_input_validation.patch} (98%)
 rename debian/patches/{71_sh_bd_purge_add_shebang.dpatch => 71_sh_bd_purge_add_shebang.patch} (71%)
 rename debian/patches/{81_phpdbconfig.dpatch => 81_phpdbconfig.patch} (72%)
 rename debian/patches/{98_autoheader.dpatch => 98_autoheader.patch} (96%)
 rename debian/patches/{99_autoconf.dpatch => 99_autoconf.patch} (99%)
 create mode 100644 debian/patches/series

diff --git a/debian/changelog b/debian/changelog
index d09a90a..f3d6319 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -1,3 +1,11 @@
+bandwidthd (2.0.1+cvs20090917-4.2) unstable; urgency=low
+
+  * Non-maintainer upload.
+  * Remove deprecated dpatch and upgrade to packaging format "3.0 quilt".
+  * Update to Standards-Version to 3.9.3 and debhelper to 9.
+
+ -- Jari Aalto <jari.aalto@cante.net>  Mon, 27 Feb 2012 05:41:41 -0500
+
 bandwidthd (2.0.1+cvs20090917-4.1) unstable; urgency=low
 
   * Non-maintainer upload.
diff --git a/debian/compat b/debian/compat
index 7ed6ff8..ec63514 100644
--- a/debian/compat
+++ b/debian/compat
@@ -1 +1 @@
-5
+9
diff --git a/debian/control b/debian/control
index 76e81c8..d16c5d9 100644
--- a/debian/control
+++ b/debian/control
@@ -2,8 +2,8 @@ Source: bandwidthd
 Section: net
 Priority: optional
 Maintainer: Andreas Henriksson <andreas@fatal.se>
-Build-Depends: debhelper (>= 5.0.0), autotools-dev, dpatch, po-debconf, libpcap0.8-dev | libpcap-dev, libgd2-noxpm-dev | libgd2-xpm-dev | libgd2-dev | libgd-noxpm-dev | libgd-xpm-dev | libgd-dev, bison, flex, libpq-dev
-Standards-Version: 3.7.3
+Build-Depends: debhelper (>= 9), autotools-dev, po-debconf, libpcap0.8-dev | libpcap-dev, libgd2-noxpm-dev | libgd2-xpm-dev | libgd2-dev | libgd-noxpm-dev | libgd-xpm-dev | libgd-dev, bison, flex, libpq-dev
+Standards-Version: 3.9.3
 Homepage: http://bandwidthd.sourceforge.net/
 
 Package: bandwidthd
diff --git a/debian/patches/00list b/debian/patches/00list
deleted file mode 100644
index 10a04a3..0000000
--- a/debian/patches/00list
+++ /dev/null
@@ -1,16 +0,0 @@
-# 2x/3x - autotools changes
-22_disableconf.dpatch
-21_fixversion.dpatch
-31_usepqsql.dpatch
-# 4x - source changes
-41_syntaxwhere.dpatch
-42_graphmailheader.dpatch
-43_cdfsyntax.dpatch
-# 6x - script source changes
-61_php_fix_html_and_input_validation.dpatch
-71_sh_bd_purge_add_shebang.dpatch
-# 8x - debian specific
-81_phpdbconfig.dpatch
-# update autogenerated files.
-98_autoheader.dpatch
-99_autoconf.dpatch
diff --git a/debian/patches/21_fixversion.dpatch b/debian/patches/21_fixversion.patch
similarity index 59%
rename from debian/patches/21_fixversion.dpatch
rename to debian/patches/21_fixversion.patch
index 54f822b..6cb91b3 100644
--- a/debian/patches/21_fixversion.dpatch
+++ b/debian/patches/21_fixversion.patch
@@ -1,10 +1,6 @@
-#! /bin/sh /usr/share/dpatch/dpatch-run
-## 21_fixversion.dpatch by Andreas Henriksson <andreas@fatal.se>
-##
-## All lines beginning with `## DP:' are a description of the patch.
-## DP: Correct version number in Makefile
+From: Andreas Henriksson <andreas@fatal.se>
+Subject: Correct version number in Makefile
 
-@DPATCH@
 --- bandwidthd-2.0.1+cvs20050208.orig/configure.in
 +++ bandwidthd-2.0.1+cvs20050208/configure.in
 @@ -7,8 +7,8 @@
diff --git a/debian/patches/22_disableconf.dpatch b/debian/patches/22_disableconf.patch
similarity index 73%
rename from debian/patches/22_disableconf.dpatch
rename to debian/patches/22_disableconf.patch
index 0b5cee5..c63b752 100644
--- a/debian/patches/22_disableconf.dpatch
+++ b/debian/patches/22_disableconf.patch
@@ -1,10 +1,6 @@
-#! /bin/sh /usr/share/dpatch/dpatch-run
-## 22_disableconf.dpatch by Andreas Henriksson <andreas@fatal.se>
-##
-## All lines beginning with `## DP:' are a description of the patch.
-## DP: Disable installation of bandwidthd.conf from orig source
+From: Andreas Henriksson <andreas@fatal.se>
+Subject: Disable installation of bandwidthd.conf from orig source
 
-@DPATCH@
 --- bandwidthd-2.0.1+cvs20050208.orig/Makefile.in
 +++ bandwidthd-2.0.1+cvs20050208/Makefile.in
 @@ -50,7 +50,7 @@
diff --git a/debian/patches/31_usepqsql.dpatch b/debian/patches/31_usepqsql.patch
similarity index 84%
rename from debian/patches/31_usepqsql.dpatch
rename to debian/patches/31_usepqsql.patch
index 845157b..6943bd3 100644
--- a/debian/patches/31_usepqsql.dpatch
+++ b/debian/patches/31_usepqsql.patch
@@ -1,12 +1,8 @@
-#! /bin/sh /usr/share/dpatch/dpatch-run
-## 31_usepgqsql.dpatch by Andreas Henriksson <andreas@fatal.se>
-##
-## All lines beginning with `## DP:' are a description of the patch.
-## DP: Add configure option --enable-pgsql to manually be able to select 
-## DP: instead of automagically choosing at build-time, to be able to build 
-## DP: both the static- and postgresql-version of bandwidthd
+From: Andreas Henriksson <andreas@fatal.se>
+Subject: Add configure option --enable-pgsql.
+ Manually select instead of automagically choosing at build-time, to be
+ able to build both the static- and postgresql-version of bandwidthd
 
-@DPATCH@
 diff -urNad bandwidthd-2.0.1+cvs20071208~/configure.in bandwidthd-2.0.1+cvs20071208/configure.in
 --- bandwidthd-2.0.1+cvs20071208~/configure.in	2007-12-11 13:51:23.000000000 +0100
 +++ bandwidthd-2.0.1+cvs20071208/configure.in	2007-12-11 13:51:50.000000000 +0100
diff --git a/debian/patches/41_syntaxwhere.dpatch b/debian/patches/41_syntaxwhere.patch
similarity index 63%
rename from debian/patches/41_syntaxwhere.dpatch
rename to debian/patches/41_syntaxwhere.patch
index ced6199..eca2525 100644
--- a/debian/patches/41_syntaxwhere.dpatch
+++ b/debian/patches/41_syntaxwhere.patch
@@ -1,11 +1,6 @@
-#! /bin/sh /usr/share/dpatch/dpatch-run
-## 41_syntaxwhere.dpatch by Andreas Henriksson <andreas@fatal.se>
-##
-## All lines beginning with `## DP:' are a description of the patch.
-## DP: Say which file the syntax error is in, to make logged error message 
-## DP: clear.
+From: Andreas Henriksson <andreas@fatal.se>
+Subject: Say which file the syntax error is in, to make log message clear
 
-@DPATCH@
 --- bandwidthd-2.0.1+cvs20050208.orig/conf.y
 +++ bandwidthd-2.0.1+cvs20050208/conf.y
 @@ -20,8 +20,8 @@
diff --git a/debian/patches/42_graphmailheader.dpatch b/debian/patches/42_graphmailheader.patch
similarity index 87%
rename from debian/patches/42_graphmailheader.dpatch
rename to debian/patches/42_graphmailheader.patch
index e75bbe5..866872f 100644
--- a/debian/patches/42_graphmailheader.dpatch
+++ b/debian/patches/42_graphmailheader.patch
@@ -1,10 +1,6 @@
-#! /bin/sh /usr/share/dpatch/dpatch-run
-## 42_graphmailheader.dpatch by Andreas Henriksson <andreas@fatal.se>
-##
-## All lines beginning with `## DP:' are a description of the patch.
-## DP: Add missing "MAIL" table header to generated static html.
+From: Andreas Henriksson <andreas@fatal.se>
+Subject: Add missing "MAIL" table header to generated static html.
 
-@DPATCH@
 -
 --- bandwidthd-2.0.1+cvs20090917/graph.c.orig	2009-09-17 16:08:24.000000000 +0200
 +++ bandwidthd-2.0.1+cvs20090917/graph.c	2009-09-17 16:09:02.000000000 +0200
diff --git a/debian/patches/43_cdfsyntax.dpatch b/debian/patches/43_cdfsyntax.patch
similarity index 76%
rename from debian/patches/43_cdfsyntax.dpatch
rename to debian/patches/43_cdfsyntax.patch
index a9e3aa1..5a8afef 100644
--- a/debian/patches/43_cdfsyntax.dpatch
+++ b/debian/patches/43_cdfsyntax.patch
@@ -1,10 +1,6 @@
-#! /bin/sh /usr/share/dpatch/dpatch-run
-## 43_cdfsyntax.dpatch by Harald Hvaal <harald.hvaal@gmail.com>
-##
-## All lines beginning with `## DP:' are a description of the patch.
-## DP: Add missing comma to fix syntax in created CDF files.
+From: Harald Hvaal <harald.hvaal@gmail.com>
+Subject: Add missing comma to fix syntax in created CDF files.
 
-@DPATCH@
 --- a/bandwidthd.c.orig	2010-05-31 20:11:43.000000000 +0200
 +++ b/bandwidthd.c	2010-05-31 20:11:50.000000000 +0200
 @@ -910,7 +910,7 @@
diff --git a/debian/patches/61_php_fix_html_and_input_validation.dpatch b/debian/patches/61_php_fix_html_and_input_validation.patch
similarity index 98%
rename from debian/patches/61_php_fix_html_and_input_validation.dpatch
rename to debian/patches/61_php_fix_html_and_input_validation.patch
index a95392e..ddc982b 100644
--- a/debian/patches/61_php_fix_html_and_input_validation.dpatch
+++ b/debian/patches/61_php_fix_html_and_input_validation.patch
@@ -1,10 +1,6 @@
-#! /bin/sh /usr/share/dpatch/dpatch-run
-## 61_php_fix_html_and_input_validation.dpatch by Andreas Henriksson <andreas@fatal.se>
-##
-## All lines beginning with `## DP:' are a description of the patch.
-## DP: Make HTML output valid and prevent sql injection in php code.
+From: Andreas Henriksson <andreas@fatal.se>
+Subject: Make HTML output valid and prevent sql injection in php code.
 
-@DPATCH@
 diff -urNad bandwidthd-2.0.1+cvs20071208~/phphtdocs/details.php bandwidthd-2.0.1+cvs20071208/phphtdocs/details.php
 --- bandwidthd-2.0.1+cvs20071208~/phphtdocs/details.php	2005-11-17 17:31:04.000000000 +0100
 +++ bandwidthd-2.0.1+cvs20071208/phphtdocs/details.php	2007-12-08 21:54:26.000000000 +0100
@@ -534,7 +530,7 @@ diff -urNad bandwidthd-2.0.1+cvs20071208~/phphtdocs/sensors.php bandwidthd-2.0.1
 +		$url = '<a href="#' . $r['ip'] . '">';
 +	echo "<tr><td>" . $url . $r['ip'] . "</a></td><td>" . gethostbyaddr($r['ip']) . "</td>";
  	echo fmtb($r['total']).fmtb($r['sent']).fmtb($r['received']).
-		fmtb($r['tcp']).fmtb($r['udp']).fmtb($r['icmp']).fmtb($r['http']).fmtb($r['mail']).
+ 		fmtb($r['tcp']).fmtb($r['udp']).fmtb($r['icmp']).fmtb($r['http']).fmtb($r['mail']).
 -		fmtb($r['p2p']).fmtb($r['ftp'])."\n";
 +		fmtb($r['p2p']).fmtb($r['ftp'])."</tr>\n";
  	}
diff --git a/debian/patches/71_sh_bd_purge_add_shebang.dpatch b/debian/patches/71_sh_bd_purge_add_shebang.patch
similarity index 71%
rename from debian/patches/71_sh_bd_purge_add_shebang.dpatch
rename to debian/patches/71_sh_bd_purge_add_shebang.patch
index a6426b1..e1cd3f9 100644
--- a/debian/patches/71_sh_bd_purge_add_shebang.dpatch
+++ b/debian/patches/71_sh_bd_purge_add_shebang.patch
@@ -1,10 +1,6 @@
-#! /bin/sh /usr/share/dpatch/dpatch-run
-## 71_sh_bd_purge_add_shebang.dpatch by Andreas Henriksson <andreas@fatal.se>
-##
-## All lines beginning with `## DP:' are a description of the patch.
-## DP: Add proper script header and use for loop, since echo -e is bashism.
+From: Andreas Henriksson <andreas@fatal.se>
+Subject: Add proper script header and use for loop, since echo -e is bashism.
 
-@DPATCH@
 diff -urNad bandwidthd-2.0.1+cvs20071208~/phphtdocs/bd_pgsql_purge.sh bandwidthd-2.0.1+cvs20071208/phphtdocs/bd_pgsql_purge.sh
 --- bandwidthd-2.0.1+cvs20071208~/phphtdocs/bd_pgsql_purge.sh	2005-01-07 20:40:41.000000000 +0100
 +++ bandwidthd-2.0.1+cvs20071208/phphtdocs/bd_pgsql_purge.sh	2008-03-17 10:42:37.000000000 +0100
diff --git a/debian/patches/81_phpdbconfig.dpatch b/debian/patches/81_phpdbconfig.patch
similarity index 72%
rename from debian/patches/81_phpdbconfig.dpatch
rename to debian/patches/81_phpdbconfig.patch
index 32d28ca..929a828 100644
--- a/debian/patches/81_phpdbconfig.dpatch
+++ b/debian/patches/81_phpdbconfig.patch
@@ -1,11 +1,7 @@
-#! /bin/sh /usr/share/dpatch/dpatch-run
-## 81_phpdbconfig.dpatch by Andreas Henriksson <andreas@fatal.se>
-##
-## All lines beginning with `## DP:' are a description of the patch.
-## DP: Modify php configuration to fetch postgresql auth params from
-## DP: dbconfig-common generated file.
+From: Andreas Henriksson <andreas@fatal.se>
+Subject: Modify php configuration to fetch postgresql auth params from
+ dbconfig-common generated file.
 
-@DPATCH@
 diff -urNad bandwidthd-2.0.1+cvs20071208~/phphtdocs/config.conf bandwidthd-2.0.1+cvs20071208/phphtdocs/config.conf
 --- bandwidthd-2.0.1+cvs20071208~/phphtdocs/config.conf	2007-09-04 22:14:25.000000000 +0200
 +++ bandwidthd-2.0.1+cvs20071208/phphtdocs/config.conf	2007-12-08 21:55:48.000000000 +0100
diff --git a/debian/patches/98_autoheader.dpatch b/debian/patches/98_autoheader.patch
similarity index 96%
rename from debian/patches/98_autoheader.dpatch
rename to debian/patches/98_autoheader.patch
index 62967c5..6d3f66a 100644
--- a/debian/patches/98_autoheader.dpatch
+++ b/debian/patches/98_autoheader.patch
@@ -1,10 +1,6 @@
-#! /bin/sh /usr/share/dpatch/dpatch-run
-## 98_autoheader.dpatch by Andreas Henriksson <andreas@fatal.se>
-##
-## All lines beginning with `## DP:' are a description of the patch.
-## DP: Run autoheader && rm -rf autom4te.cache
+From: Andreas Henriksson <andreas@fatal.se>
+Subject: Run autoheader && rm -rf autom4te.cache
 
-@DPATCH@
 diff -urNad bandwidthd-2.0.1+cvs20071208~/config.h.in bandwidthd-2.0.1+cvs20071208/config.h.in
 --- bandwidthd-2.0.1+cvs20071208~/config.h.in	1970-01-01 01:00:00.000000000 +0100
 +++ bandwidthd-2.0.1+cvs20071208/config.h.in	2007-12-11 14:32:51.000000000 +0100
diff --git a/debian/patches/99_autoconf.dpatch b/debian/patches/99_autoconf.patch
similarity index 99%
rename from debian/patches/99_autoconf.dpatch
rename to debian/patches/99_autoconf.patch
index dfe49f8..d777a39 100644
--- a/debian/patches/99_autoconf.dpatch
+++ b/debian/patches/99_autoconf.patch
@@ -1,10 +1,6 @@
-#! /bin/sh /usr/share/dpatch/dpatch-run
-## 99_autoconf.dpatch by Andreas Henriksson <andreas@fatal.se>
-##
-## All lines beginning with `## DP:' are a description of the patch.
-## DP: Run autoconf && rm -rf autom4te.cache
+From: Andreas Henriksson <andreas@fatal.se>
+Subject: Run autoconf && rm -rf autom4te.cache
 
-@DPATCH@
 diff -urNad bandwidthd-2.0.1+cvs20071208~/configure bandwidthd-2.0.1+cvs20071208/configure
 --- bandwidthd-2.0.1+cvs20071208~/configure	1970-01-01 01:00:00.000000000 +0100
 +++ bandwidthd-2.0.1+cvs20071208/configure	2007-12-11 13:52:30.000000000 +0100
diff --git a/debian/patches/series b/debian/patches/series
new file mode 100644
index 0000000..5229a19
--- /dev/null
+++ b/debian/patches/series
@@ -0,0 +1,16 @@
+# 2x/3x - autotools changes.patch
+22_disableconf.patch
+21_fixversion.patch
+31_usepqsql.patch
+# 4x - source changes.patch
+41_syntaxwhere.patch
+42_graphmailheader.patch
+43_cdfsyntax.patch
+# 6x - script source changes.patch
+61_php_fix_html_and_input_validation.patch
+71_sh_bd_purge_add_shebang.patch
+# 8x - debian specific.patch
+81_phpdbconfig.patch
+# update autogenerated files..patch
+98_autoheader.patch
+99_autoconf.patch
diff --git a/debian/rules b/debian/rules
index 96b8029..2f25b33 100755
--- a/debian/rules
+++ b/debian/rules
@@ -6,7 +6,6 @@
 # Uncomment this to turn on verbose mode.
 #export DH_VERBOSE=1
 
-include /usr/share/dpatch/dpatch.make
 
 configureoptions = --prefix=/usr --bindir=/usr/sbin/ --sysconfdir=/etc/bandwidthd/ --localstatedir=/var/lib/
 
@@ -57,7 +56,7 @@ configure-bwdpgsql-stamp:
 	touch $@
 
 
-build: patch-stamp
+build:
 
 build-bwdstatic: configure-bwdstatic build-stamp
 build-bwdpgsql: configure-bwdpgsql build-stamp
@@ -71,7 +70,7 @@ build-stamp:
 	touch $@
 
 
-clean: unpatch
+clean:
 	dh_testdir
 	dh_testroot
 	debconf-updatepo # update debian/po/templates.pot
diff --git a/debian/source/format b/debian/source/format
index d3827e7..163aaf8 100644
--- a/debian/source/format
+++ b/debian/source/format
@@ -1 +1 @@
-1.0
+3.0 (quilt)
-- 
1.7.9

