Description: fix possible privilege escalation via policykit UID lookup race.
Author: Marc Deslauriers <marc.deslauriers@canonical.com>

Index: apt-xapian-index-0.45ubuntu2/update-apt-xapian-index-dbus
===================================================================
--- apt-xapian-index-0.45ubuntu2.orig/update-apt-xapian-index-dbus	2012-10-31 09:07:53.000000000 -0400
+++ apt-xapian-index-0.45ubuntu2/update-apt-xapian-index-dbus	2013-09-13 14:41:36.564345788 -0400
@@ -34,15 +34,8 @@
                                     "/org/freedesktop/PolicyKit1/Authority", 
                                     "org.freedesktop.PolicyKit1.Authority")
         policykit = dbus.Interface(obj, "org.freedesktop.PolicyKit1.Authority")
-        info = dbus.Interface(connection.get_object('org.freedesktop.DBus',
-                                              '/org/freedesktop/DBus/Bus', 
-                                              False), 
-                              'org.freedesktop.DBus')
-        pid = info.GetConnectionUnixProcessID(sender) 
-        subject = ('unix-process', 
-                   { 'pid' : dbus.UInt32(pid, variant_level=1),
-                     'start-time' : dbus.UInt64(0, variant_level=1),
-                   }
+        subject = ('system-bus-name', 
+                   { 'name': dbus.String(sender, variant_level = 1) }
                   )
         details = { '' : '' }
         flags = dbus.UInt32(1) #   AllowUserInteraction = 0x00000001
